## translation metadata
# Based-On-Revision: 13768
# Last-Translator: mail (a.t) oliverknapp. de

#include "head.wmi" TITLE="Tor: Konfigurationsanleitung für versteckte Dienste" CHARSET="UTF-8"

<div class="center">

<div class="main-column">

<h1>Versteckte Dienste bei <a href="<page index>">Tor</a> einrichten</h1> <hr
/>

<p>Mit Tor ist es möglich, versteckte Dienste, die sogenannten Hidden Services,
anzubieten. Dies funktioniert sowohl mit einem Tor-Knoten, als auch mit einem
Client. Damit kann man zum Beispiel einen Webserver, einen Mailserver oder
einen SSH-Server anbieten, ohne die Identität preiszugeben. Es ist sogar
möglich, solch einen Dienst hinter einer Firewall zu betreiben. </p>

<p>Wenn du bereits Tor installiert hast, kannst du einen Versteckten Dienst
live unter <a href="http://duskgytldkxiuqc6.onion/">duskgytldkxiuqc6.onion</a>
erleben. </p>

<p>In diesem HowTo erfährst du, wie du eine eigene, versteckte Webseite
betreiben kannst.</p>

<hr /> <a id="zero"></a> <h2><a class="anchor" href="#zero">Schritt Null:
Bekomme Tor und Privoxy zum Laufen</a></h2> <br />

<p>Bevor es losgeht, überprüfe folgendes:</p> <ol> <li>Tor ist installiert und
läuft,</li> <li>Privoxy installiert und läuft,</li> <li>Privoxy ist richtig
eingerichtet und benutzt Tor und</li> <li>alles funktioniert so wie es
soll.</li> </ol>

<p>Windows Nutzer sollten dem <a href="<page docs/tor-doc-windows>">Windows
HowTo</a>, OS X Nutzer dem <a href="<page docs/tor-doc-osx>">OS X HowTo</a>,
und Linux/BSD/Unix Nutzer dem <a href="<page docs/tor-doc-unix>">Unix HowTo</a>
 folgen.</p>

<p>Wenn du alles eingerichtet hast, versuche nochmal den oben erwähnten
Versteckten Dienst unter <a href="http://duskgytldkxiuqc6.onion/">
duskgytldkxiuqc6.onion</a> zu erreichen. Normalerweise dauert es zwischen
10-60 Sekunden, bis die Seite geladen ist (oder bis sich herausstellt, dass
die Seite gerade unerreichbar ist) Wenn es gleich zu Beginn fehlschlägt und
dein Browser eine Meldung bringt wie "www.duskgytldkxiuqc6.onion could not be
found, please check the name and try again" scheinst du Tor und Privoxy nicht
richtig konfiguriert zu haben; Es gibt einen <a
href="https://wiki.torproject.org/noreply/TheOnionRouter/TorFAQ#ItDoesntWork">
Es-geht-nicht FAQ Eintrag</a>, der dir vielleicht weiterhelfen kann. </p>

<hr /> <a id="one"></a> <h2><a class="anchor" href="#one">Schritt Eins:
Installiere einen lokalen Webserver</a></h2> <br />

<p>Als Erstes musst du einen lokalen Webserver einrichten. Das kann durchaus
kompliziert sein, daher können wir nur ganz grundlegende Hilfestellung geben.
Solltest du Probleme haben, frage einen Freund um Hilfe. Wir empfehlen die
Installation eines neuen, separaten Webservers für den versteckten Dienst,
weil du einen bereits installierten möglicherweise bereits für eine andere
Seite benutzt oder mal benutzen möchtest. </p>

<p>Wenn du Unix oder OS X benutzt und dich mit der Kommandozeile auskennst,
ist der beste Weg, wenn du dir <a href="http://www.acme.com/software/thttpd/">
thttpd</a> installierst. Hol dir einfach den neuesten Tarball und entpacke
ihn. Mittels <kbd>./configure &amp;&amp; make</kbd> wird der Server
installiert. Danach musst du noch <kbd>mkdir hidserv; cd hidserv</kbd>
eingeben und danach mittels <kbd>../thttpd -p 5222 -h localhost</kbd> den
Server starten. Du landest wieder auf der Kommandozeile, hast aber jetzt einen
Webserver auf Port 5222 laufen. Du kannst Dateien die er ausliefern soll
einfach in das hidserv Verzeichnis legen. </p>

<p>Wenn du unter Windows arbeitest, wählst du am Besten <a
href="http://savant.sourceforge.net/">Savant</a> oder <a
href="http://httpd.apache.org/">Apache</a>. Versichere dich aber, dass der
Server nur an localhost gebunden ist. Ausserdem solltest du wissen, auf
welchem Port der Server lauscht, diese Information brauchst du gleich. </p>

<p>(Das Binden an localhost stellt sicher, dass der Server nur über Tor
ansprechbar ist. Ansonsten könnte man vielleicht auf diese Weise den Betreiber
des versteckten Dienstes enttarnen.) </p>

<p>Wenn du den Server eingerichtet hast, solltest du dich davon überzeugen,
dass er funktioniert: starte deinen Browser und besuche <a
href="http://localhost:5222/">http://localhost:5222/</a>. 5222 ist der Port, an
dem dein Webserver lauscht. Wenn das geht, versuche eine Datei in das
Verzeichniss zu legen und schaue ob sie im Browser auftaucht, wenn du die
Ansicht aktualisierst. </p>

<hr /> <a id="two"></a> <h2><a class="anchor" href="#two">Schritt Zwei:
Einrichtung des versteckten Dienstes</a></h2> <br />

<p>Als nächsten Schritt musst du deinen versteckten Dienst einrichten, damit
er auf deinen Webserver zeigt. </p>

<p>Erstens: Öffne deine torrc in einem Text-Editor. (Unter <a
href="https://wiki.torproject.org/noreply/TheOnionRouter/TorFAQ#torrc">torrc
FAQ Eintrag</a> steht was das bedeutet.) Scrolle etwa in die Mitte und suche
nach der folgenden Zeile:</p>

<pre> \############### This section is just for location-hidden services ###
</pre>

<p> Dieser Abschnitt besteht aus Zeilengruppen. Jede steht für einen
versteckten Dienst. Zu Beginn sind alle auskommentiert (haben also ein # als
erstes Zeichen), versteckte Dienste sind also nicht aktiv. Jede Zeilengruppe
besteht aus einer <var>HiddenServiceDir</var> Zeile und einer oder mehreren
<var> HiddenServicePort</var> Zeilen:</p> <ul> <li><var>HiddenServiceDir</var>
ist ein Verzeichniss in dem Tor Informationen über den Hidden Service
speichert. Genauer gesagt: Tor wird hier eine Datei namens <var>hostname</var>
erstellen, in der die onion URL des versteckte Dienste steht. Du musst keine
Dateien in das Verzeichniss legen.</li> <li><var>HiddenServicePort</var> lässt
dich einen virtuellen Port (das ist der Port, mit dem Nutzer auf deinen
versteckten Dienst zugreifen können) und eine IP-Adresse sowie Port (an welche
die Anfragen dann weitergeleitet werden) festlegen. </li> </ul>

<p>Damit unser Beispiel-Webserver funktioniert, musst du die folgenden Zeilen
in deine torrc hinzufügen: </p>

<pre> HiddenServiceDir /Library/Tor/var/lib/tor/hidden_service/
HiddenServicePort 80 127.0.0.1:5222 </pre>

<p>Du solltest das <var>HiddenServiceDir</var> so wählen, dass der Nutzer der
Tor laufen lässt darauf Lese- und Schreibzugriff besitzt. Die Zeile oben
sollte für das OS X Paket funktionieren. Unter Unix, müsste
"/home/username/hidserv/" gehen (natürlich musst du "username" mit deinem
eigenen Benutzernamen ersetzen). Unter Windows sollte folgendes funktionieren
(auch mit richtigem username natürlich):</p> <pre> HiddenServiceDir
C:\Documents and Settings\username\Application Data\hidden_service\\
HiddenServicePort 80 127.0.0.1:5222 </pre>

<p>Jetzt musst du deine veränderte torrc speichern und Tor neustarten. </p>

<p>Wenn Tor startet, ist das schon mal super. Wenn nicht, ist etwas schief
gegangen. Als erstes solltest du in deinen Logfiles nach Hinweisen suchen. Tor
wird Warnungen oder sogar Fehler ausgeben. Damit solltest du in der Lage sein,
das Problem einzugrenzen. Typischerweise hast du Tippfehler in deiner torrc
oder fehlende Schreib- und Leserechte in den angegebenen Verzeichnissen.
(Unter <a
href="https://wiki.torproject.org/noreply/TheOnionRouter/TorFAQ#Logs">Der
Logfile FAQ Eintrag</a> findest du weitere Hilfe, wenn du Probleme hast die
Logs zu finden oder zu aktivieren. </p>

<p>Wenn Tor startet wird es automatisch das <var>HiddenServiceDir</var>, das du
angegeben hast, erstellen (wenn nötig) und darin 2 Dateien ablegen.</p>

<dl> <dt><var>private_key</var></dt> <dd>Als Erstes wird Tor ein neues
Schlüsselpaar mit öffentlichem und privatem Schlüssel für deinen versteckten
Dienst erzeugen. Dieses Paar wird in die Datei namens "private_key"
geschrieben. Diese Datei darfst du unter keinen Umständen weitergeben,
ansonsten könnten andere deine Identität annehmen.</dd> <dt><var>hostname</var>
 </dt> <dd>Die andere Datei die Tor erstellt nennt sich "hostname". Dabei
handelt es sich um eine kurze Zusammenfassung deines öffentlichen Schlüssels.
Diese Zusammenfassung sieht etwa folgendermaßen aus: <tt>
duskgytldkxiuqc6.onion</tt>. Dabei handelt es sich gleichzeitig auch um die
Adresse deines versteckte Dienste, die du an andere Menschen weitergeben oder
z.B. im Internet veröffentlichen kannst. </dd> </dl>

<p>Wenn Tor unter einem anderen Benutzeraccount läuft musst du möglicherweise
root Rechte haben, damit du die Dateien anschauen kannst.</p>

<p>Nach einem Neustart ist Tor erstmal damit beschäftigt sogenannte
Introduction Points auszuwählen und einen <em>hidden service descriptor</em>
zu generieren. Dabei handelt es sich um eine unterschriebene Liste von
Introduction Points mit dem vollständigen öffentlichen Schlüssel des
versteckten Dienstes. Diese Beschreibung veröffentlicht dein Client dann
anonym auf den Verzeichnis Servern wo andere Leute, die deinen versteckten
Dienst besuchen wollen, ihn dann ebenfalls anonym abrufen. </p>

<p>Jetzt kannst du es versuchen: Kopiere den Inhalt der hostname Datei in
deinen Webbrowser. Wenn es klappt solltest du die lokale HTML-Seite bekommen,
die du in Schritt Eins eingerichtet hast. Wenn es nicht geht, schau in deinen
Logs nach Hinweisen und versuche diesen Nachzugehen, bis es klappt. </p>

<hr /> <a id="three"></a> <h2><a class="anchor" href="#three">Schritt Drei:
Tipps für Fortgeschrittene</a></h2> <br />

<p>Wenn du vor hast deinen versteckten Dienst über längere Zeit anzubieten,
solltest du den privaten Schlüssel des Dienstes, also die
<var>private_key</var> Datei redundant sichern. </p>

<p>Wir haben weiter oben bewusst nicht Apache empfohlen, weil er a) vielleicht
schon für andere Webseiten auf dem Rechner eingesetzt wird und er b) sehr groß
und kompliziert ist und an vielen Stellen deine wirkliche IP verraten könnte
(z.B. auf 404 Seiten). Für Leute, die etwas mehr Funktionalität brauchen,
könnte Apache aber genau das Richtige sein. Wir bräuchten daher eine
Checkliste, wie man seinen Apache absichert, wenn du ihn für versteckte
Dienste nutzen willst. Es wäre toll, wenn die uns jemand erstellen könnte.
Savant hat möglicherweise ähnliche Probleme. </p>

<p>Wenn du mehrere virtuelle Adressen an einen einzelnen versteckten Dienst
weiterleiten willst, musst du einfach mehr <var>HiddenServicePort</var> Zeilen
einfügen. Wenn du mehrere versteckte Dienste mit dem gleichen Tor Client
anbieten möchtest, must du einfach eine weitere <var>HiddenServiceDir</var>
Zeile einfügen. Alle danach folgenden <var>HiddenServicePort</var> Zeilen
beziehen sich dann auf diese <var>HiddenServiceDir</var> Zeile bis du eine
neue <var>HiddenServiceDir</var> Zeile einfügst: </p>

<pre> HiddenServiceDir /usr/local/etc/tor/hidden_service/ HiddenServicePort 80
127.0.0.1:8080

HiddenServiceDir /usr/local/etc/tor/other_hidden_service/ HiddenServicePort
6667 127.0.0.1:6667 HiddenServicePort 22 127.0.0.1:22 </pre>

<p>Du solltest dir ein paar Gedanken über deine Anonymität machen: </p> <ul>
<li>Wie bereits erwähnt solltest du aufpassen, dass dein Webserver keine
Informationen über dich, deinen Computer oder deinen Aufenthaltsort
herausgibt. Zum Beispiel könnte jemand herausfinden ob du thttpd oder Apache
einsetzt und könnte dann auch noch etwas über dein Betriebssystem
herausfinden.</li> <li>Wenn dein Rechner nicht immer online ist, ist es auch
dein verstecker Dienst nicht. Dadurch hinterlässt du Spuren, die jemand
interessieren könnten.</li> <!-- increased risks over time --> </ul>

<hr />

<p>Wenn du Vorschläge hast, wie wir dieses Dokument verbessern könnten, <a
href="<page contact>">schick Sie uns bitte zu.</a> Danke!</p>

</div><!-- #main --> </div>

#include <foot.wmi>

